# <p align ="center"> Road Accident Severity Prediction </p>

## 1. Title and Author
- Prepared for UMBC Data Science Master Degree Capstone by Dr Chaoji (Jay) Wang 
- Author: Chikkala PS ManikantaVijayaSri NarasimhaNaidu, UMBC, Fall-2023 Semester
- GitHub Link: https://github.com/narasimhachikkala
- LinkedIn profile: https://www.linkedin.com/in/narasimha-naidu-chikkala
- youtube link: https://youtu.be/5gnWX30M0lY
- PPT Link: [Presentation.pptx](https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/blob/main/docs/DATA_606_PPT.pptx)

## 2. Background
The project is about predicting the severity of road accidents in a specific region. It accomplishes this by analyzing historical data related to road accidents in that region. The project involves training a predictive model using the historical accident data. Once the model is trained, it can be used to make predictions about the severity of accidents when given new input data, such as information about a recent accident. In essence, this project aims to create a tool or system that can assess and predict the level of severity for road accidents based on historical patterns and data analysis, potentially aiding in better accident prevention and response efforts in the specified region. This project matters because it has the potential to improve road safety, save lives, optimize resource allocation, and contribute to more effective accident prevention and response strategies in the specified region.

### Research Questions :
a. What temporal or seasonal trends exist in accident severity within the target  region, and how can these patterns be incorporated into the predictive analysis? 

b. Which specific factors exhibit the greatest influence on road accident severity within the target region, and how can this understanding inform the predictive modeling process?

c. Based on the predictions generated by the model, what actionable interventions and preventive measures can be recommended to mitigate road accident severity in the target region, and how can these recommendations be effectively implemented?

### Architecture Diagram:
<img width="1022" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/6efd6fda-f41a-460f-acf3-73f071de9927">

## 3. Data

Description : This dataset reports details of all traffic collisions occurring on county and local roadways within Montgomery County, of the Maryland State from 2015 to September 2023. Each row consists details about crash report.

**3.1 Data Source** : *[dataset](https://catalog.data.gov/dataset/crash-reporting-drivers-data)*. :link:

   Data Size : 79 MB

**3.2 Data Shape**
   > - Number of columns =  43
   > - Number of rows    = 164,926

**3.3 Data dictionary:**
   
| Column Name | Description                                                                                      | Data Type        | Potential Values  |
|----------------------------| :--------------------------------------------------------------------------------------------------:|:------------------:|:-------------------:|
| Report Number              | A unique identifier for the accident report.                                                      | Object           | MCP3040003N                 |
| Local Case Number          | A local reference number or identifier for the specific accident case.                              | Object           | 190026050                 |
| Agency Name                | The name of the agency or organization responsible for reporting and handling the accident data.    | Object           | Montgomery County Police                 |
| ACRS Report Type           | The type or format of the accident report (e.g., official accident report, summary report, etc.).   | Object           | Property Damage,Injury crasg=h, Fatal crash                 |
| Crash Date/Time            | The date and time when the accident occurred.                                                       | Object           | 07/13/2023 05:40:00 PM                 |
| Route Type                 | The type of road or route where the accident took place (e.g., highway, street, etc.).                | Object           | Municipality, Maryland(state),County                 |
| Road Name                  | The name of the road where the accident occurred.                                                     | Object           | Selfridge rd, Perry pkwy                 |
| Cross-Street Type          | The type of intersecting road (e.g., street, avenue, etc.).                                           | Object           | County                 |
| Cross-Street Name          | The name of the intersecting road.                                                                   | Object           | Randolph Rd, Shady grove Rd                 |
| Off-Road Description       | A description of the accident's location in relation to the road (e.g., on a shoulder, in a parking lot, etc.). | Object       | Parking lot of 3215 spartan rd                 |
| Municipality               | The city or municipality where the accident occurred.                                                  | Object           | Gaithersburg                 |
| Related Non-Motorist       | Any non-motorist involved in the accident (e.g., pedestrians, cyclists).                                | Object           | Bicyclist                 |
| Collision Type             | The type of collision that occurred (e.g., rear-end, head-on, sideswipe).                                 | Object           | Same dir rear end, head on, other                 |
| Weather                    | The weather conditions at the time of the accident (e.g., rainy, sunny, foggy).                           | Object           | Clear, cloudy                 |
| Surface Condition          | The road surface condition (e.g., dry, wet, icy).                                                         | Object           | dry, wet                 |
| Light                      | The lighting conditions at the time of the accident (e.g., daylight, dark, dusk).                         | Object           | daylight, dusk                 |
| Traffic Control            | Information about traffic control devices at the accident site (e.g., traffic signal, stop sign).           | Object           | Traffic signals, no controls                |
| Driver Substance Abuse     | Whether the driver was under the influence of substances (e.g., alcohol, drugs).                           | Object           | None Detected, alcohol present          |
| Non-Motorist Substance Abuse | Whether a non-motorist involved in the accident was under the influence of substances.                    | Object        | None Detected, alcohol present           |
| Person ID                  | A unique identifier for individuals involved in the accident.                                             | Object           | DE2A24CD-7919-4F8D-BABF-5B75CE12D21E                 |
| Driver At Fault            | Whether the driver was deemed at fault for the accident.                                                   | Object           | Yes, No           |
| Injury Severity            | The severity of injuries sustained by individuals involved in the accident (e.g., minor, serious, fatal).  | Object           | No apparent injury, suspected minor injury |
| Circumstance               | Additional circumstances or factors related to the accident.                                               | Object           | Animal                |
| Driver Distracted By       | What distracted the driver, if applicable.                                                               | Object           | not distracted, looked but did not see                  |
| Drivers License State      | The state where the driver's license was issued.                                                          | Object           | MD,CA                 |
| Vehicle ID                 | A unique identifier for vehicles involved in the accident.                                                 | Object           | 165AD539-A8C8-4004-AF73-B7DCAAA8B3CC                 |
| Vehicle Damage Extent      | The extent of damage to the vehicle (e.g., minor, moderate, severe).                                       | Object           | SUPERFICIAL,FUNCTIONAL |
| Vehicle First Impact Location | The location on the vehicle where the first impact occurred.                                              | Object         | ONE OCLOCK,SEVEN OCLOCK                 |
| Vehicle Second Impact Location | The location on the vehicle where the second impact occurred.                                            | Object         | ONE OCLOCK,SEVEN OCLOCK                 |
| Vehicle Body Type          | The type of vehicle body (e.g., sedan, SUV, truck).                                                       | Object           | PASSENGER CAR,(SPORT) UTILITY VEHICLE                 |
| Vehicle Movement           | The movement or action of the vehicle at the time of the accident.                                        | Object           | PARKING,MOVING                 |
| Vehicle Continuing Dir     | The direction in which the vehicle continued after the accident.                                          | Object           | North,South                 |
| Vehicle Going Dir          | The direction the vehicle was heading before the accident.                                                | Object           | North,South                 |
| Speed Limit                | The posted speed limit on the road where the accident occurred.                                           | Int64            | 15,0,30                 |
| Driverless Vehicle         | Indicates if a driverless (autonomous) vehicle was involved.                                              | Object           | Yes, No           |
| Parked Vehicle             | Indicates if a parked vehicle was involved.                                                               | Object           | Yes, No           |
| Vehicle Year               | The year the vehicle was manufactured.                                                                   | Int64            | 2003,2004                 |
| Vehicle Make               | The make or manufacturer of the vehicle.                                                                 | Object           | HONDA, UNK, FORD                 |
| Vehicle Model              | The model of the vehicle.                                                                                 | Object           | TK,UNK                 |
| Equipment Problems         | Any equipment or vehicle problems noted.                                                                  | Object           | -                 |
| Latitude                   | The geographical latitude coordinate of the accident location.                                            | Float            | 39.15004368                 |
| Longitude                  | The geographical longitude coordinate of the accident location.                                           | Float            |  -77.06308884               |
| Location                   | A general description of the accident location.                                                           | Object           | (39.15004368, -77.06308884)                 |



**3.4 Which variable/column will be your target/label in your ML model?**
    - Injury Severity

      It can Classified into:
      
         - FATAL INJURY(0) 
         - NO APPARENT INJURY(1)          
         - POSSIBLE INJURY(2)              
         - SUSPECTED MINOR INJURY(3)      
         - SUSPECTED SERIOUS INJURY(4)     
                  

**3.5 Which variables/columns may selected as features/predictors for your ML models?**
   - Since there are too many features and adding all the features will increase noise in the model so the features are selected after performing the basic EDA and applying feature selection algos (PCA, dimensionality reduction, selectKbest).


## 4. EDA 


### 4.1 Checking the Null values
- I checked for the Null values in all columns I found that are there are more null values for the columns like Off-Road Description, Municipality,
and Related Non-Motorist these colums are removed from the dataset as the weightage of these columns doesn't affect the prediction.
### 4.2 Filling the Null values
- Filled the nulls in some columns which are required for the prediction.
### 4.3 Data Cleansing and Data Visualization
- Performed Data Cleansing as there are more nulls in some columns.
- Initially, I removed some columns like Report_Number, Person_ID and others as they don't have more impact in our prediction. But these columns may be used later depending on the evaluation metrics of the model.
- This is an Multiclass classification problem. So, Assigned 0,1,2,3,4 values to the target variable.
- Next, I did One-Hot Encoding to convert categorical variables into a numerical format.
- I also Standardized latitude and longitude using StandardScaler which improve the stability, and interpretability.
- Moving to Data Visualization, I plotted some graphs using plotly which are neccessary for the analysis
#### 4.3.1 Injury Severity for Each month
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/bb0307cd-90ef-4123-ac17-c5c3b4028056">

#### 4.3.2 Accidents recorded each month
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/1dcc37c8-f092-4f37-aad0-cdeff44084d2">
 
 #### 4.3.3 Accidents recorded each year
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/aa9b9134-e5be-465b-b608-7c7fd2093cf3">

 #### 4.3.4 Avg number of accidents recorded from jan-june (first half) and july- dec (second half)
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/35bc1f07-655f-4bc1-ba28-0ee5faab60ca">

 #### 4.3.5 Accidents by Weather
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/67be30b5-09bf-433c-af98-ac2aac3e7ce9">

 #### 4.3.6 Surface Conditions for Accidents
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/3bbc2723-53a7-4f32-aff7-75e6a4e55b08">

 #### 4.3.7 Count of Injury Severity by Agency Names
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/d14d818b-a7a2-4af5-a396-bc8a2b002c47">

 #### 4.3.8 Total Accidents Reported in Daylight vs. Night
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/a7a30117-a29c-4dc2-b5e1-90aa04a89d2e">

 #### 4.3.9 Accidents by Day/Night per Year
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/f669981e-d635-460d-9891-09582c1293e7">

 #### 4.3.10 Number of Accidents vs. Speed Limit (Year-wise)
 <img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/357a6be7-5d29-4a68-8f59-504b0fa715ac">

### Interpretations
- Number of accidents got decreased during the COVID period 2019-2020 and catched an upward trend after that till 2022
- Most accidents happen in the second half of the year that is during winters (sept-dec) and in Montgomery County region.
- Most of the accidents happened in the daylight. Based on this we can say more people travel on day than night.
- Most of the accidents happened when the weather is clear and road surface is dry.
- Most of the accidents happened within the speed limits of 25-40 MPH.
- Most of the accidents are no apparent injury.
  

## 5. Model Training

- Splitting the data into 80 - 20 for training and testing.
- When embarking on the model-building process, two crucial steps are essential for enhancing the model's effectiveness: balancing the data and performing feature selection.
- The combination of balanced data and judicious feature selection lays the foundation for building a robust and effective predictive model. This approach ensures that the model is trained on representative and pertinent information, enhancing its ability to generalize well to unseen data and improving overall performance.

## Data Balancing
  
SMOTE (Synthetic Minority Over-sampling Technique) is used to address class imbalance in the training data. 
Class imbalance refers to a situation where one class has significantly fewer samples than another. SMOTE generates synthetic samples for the minority class (the one with fewer samples) to balance the class distribution. It does this by creating new data points that are combinations of existing minority class samples. After applying SMOTE, the code prints the class distribution before and after SMOTE to demonstrate how it balances the classes. The resulting X_train_balanced and y_train_balanced can be used for training machine learning models that are less likely to be biased towards the majority class due to the class imbalance.

- Applied SMOTE (Synthetic Minority oversampling technique) on training data to balance the data.
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/01d58bcf-abaf-40cf-a5ba-1adedc6e603d">

## Feature Selection
- Performed the feature selection using SelectKBest method with the f_classif scoring function.
- The Features I got from SelectKBest are: 'Driver_Substance_Abuse_NONE DETECTED', 'Driver_Substance_Abuse_UNKNOWN', 'Driver_At_Fault_No', 'Driver_At_Fault_Yes', 'Driver_Distracted_By_NOT DISTRACTED', 'Driver_Distracted_By_UNKNOWN', 'Vehicle_Damage_Extent_DESTROYED', 'Vehicle_Damage_Extent_FUNCTIONAL', 'Vehicle_Damage_Extent_SUPERFICIAL', 'Equipment_Problems_NO MISUSE'

<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/f748b7b4-ef9d-4c07-bd28-4522bb634acc">


## Predictive models

## 5.1 Random Forest Classifier 

I initially employed the Random Forest Classifier for making predictions, and the results indicated an accuracy level of 0.665. This classifier, known for its ensemble learning technique, was utilized as the primary tool in the initial phase of the prediction process. The obtained accuracy of 0.665 serves as a quantitative measure of the model's performance, reflecting its ability to make correct predictions based on the provided data.
  
## Re-evaluation of features by selecting manually

I handpicked particular features for the prediction process to see if selecting them myself would boost the accuracy of the model. The idea behind personally choosing these features is to examine how they influence the model's ability to make predictions and to figure out if this customized approach improves the overall accuracy of the model. This hands-on selection of features is essentially an experiment to understand the impact of tailored feature selection on the model's predictive performance.
  
<img width="958" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/88262df1-f5ec-4d03-b78f-7977bb4a383a">

## 5.2 Random Forest Classifier using selected_feature_names

The Random Forest Classifier, when applied to a subset of manually selected features, exhibits a notable improvement in accuracy, reaching an impressive 74%. This enhancement underscores the effectiveness of strategically choosing relevant features in optimizing the model's predictive performance. The careful curation of features has proven instrumental in achieving a more precise and reliable outcome, showcasing the impact of thoughtful feature selection on the Random Forest Classifier's proficiency in the given task.

## 5.3 XGBClassifier

Afterwards, I chose to use the XGBClassifier with the goal of improving the accuracy of my predictions. This choice was made intentionally to explore different modeling techniques and make use of the strengths inherent in the XGBoost algorithm. The aim was to enhance precision and reliability in the predictions. The decision to employ the XGBClassifier was driven by the intention to fine-tune the predictive model, making it more effective and yielding results with increased accuracy. Ultimately, the XGBClassifier delivered a 68% accuracy rate, showcasing its contribution to refining the model's performance.

## 5.4 DecisionTreeClassifier

After that, I made the choice to use a Decision Tree model. By integrating a Decision Tree into the predictive modeling process, I aimed to examine its effectiveness and determine if this algorithm could enhance the overall accuracy of the predictions. This decision was part of a methodical exploration of various modeling approaches to pinpoint the most fitting one for achieving the best results in the prediction task. The Decision Tree Classifier produced an accuracy rate of 68%, signifying the model's ability to accurately predict outcomes based on the chosen features. This step was essential in understanding how the Decision Tree model contributes to the overall effectiveness of the predictive system.
  

## 5.5 Ensemble Modelling

Finally, I delved into ensemble modeling. This strategy revolves around merging predictions from several models to generate a more resilient and precise overall prediction. Through the use of ensemble techniques, particularly boosting, my objective was to capitalize on the unique strengths of different models and counteract individual weaknesses. The ultimate goal was to elevate the overall predictive performance by combining the diverse capabilities of various algorithms. Ensemble modeling stands as the culmination of efforts aimed at optimizing accuracy, taking advantage of the collaborative and complementary nature of different algorithms. This approach contributes to the development of a more comprehensive and dependable prediction framework. 

## Best Model Identified through Accuracy Scores

This visual representation highlights a notable observation: the Random Forest model, specifically when applied to a curated set of selected features, has generated a higher number of predictions compared to the other models in the analysis. This suggests that the Random Forest algorithm, when strategically employed with a focused subset of features, exhibits a greater predictive capacity than alternative models considered in the evaluation. The emphasis on feature selection appears to have a discernible impact on the overall prediction generation, underscoring the effectiveness of this approach in enhancing the model's predictive output.

<img width="971" alt="image" src="https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/d6e6f5ab-8ae3-443d-8f86-99fcb9b3ed84">
 
  
## Saving the model

After determining the best model based on accuracy, it's crucial to save it for future use. This involves preserving the model's parameters and integrating it into a Flask web application, enabling efficient and real-time predictions. The saved model serves as a valuable asset in streamlining the transition from model training to practical deployment within the web app, ensuring optimal user experience.


## 6. Web Application Using Flask

On this webpage, users can find a range of features such as month, year, weather conditions, and other attributes. Utilizing these diverse attributes, the goal is to predict the degree of severity associated with a road accident. The predictive model operates by classifying injury severity into distinct classes, each associated with a specific numerical scale. The classification scale is structured as follows:

- Class 0: Fatal Injury
- Class 1: No Apparent Injury
- Class 2: Possible Injury
- Class 3: Suspected Minor Injury
- Class 4: Suspected Serious Injury

By inputting various attributes such as the month, year, and weather conditions, the model endeavors to forecast and assign the most appropriate severity class to a potential road accident. This classification system serves as a valuable tool for users to comprehend the potential outcomes in terms of injury severity, allowing for a more informed and proactive approach to road safety. Users can thus leverage this predictive capability to better understand the potential consequences of different scenarios, aiding in the development of strategies to mitigate the severity of road accidents.

![image](https://github.com/DATA-606-2023-FALL-THURSDAY/Chikkala_PSManikantaVijayaSriNarasimhaNaidu/assets/75675597/904acfe2-83bc-46ec-a838-9cad3170c969)


## 7. Conclusion

- Number of accidents got decreased during the COVID period 2019-2020 and moved an upward trend after that till 2022.
- Most accidents happen in the second half of the year that is during winters (sept-dec).
- Most of the accidents happened in the daylight.
- Most accidents happened when the weather is clear and road surface is dry.
- Most of the accidents happened within the speed limits of 25-40 MPH.
- Most of the accident’s prediction comes out as no apparent injury.
- High accuracy is obtained from the random forest model.

\
Limitations:
- The model's performance is constrained by the availability and quality of data. Incomplete or biased data may hinder its accuracy.
- Human behavior, a key factor in road accidents, is inherently unpredictable. While models can incorporate historical data, they may not fully capture the dynamic nature of human decision-making.
- Privacy and ethical considerations surrounding the use of personal data may pose challenges. Adhering to regulatory guidelines is crucial to address these concerns.

\
Lessons Learned:
- The data preprocessing is a crucial step in shaping the predictive accuracy of our models. The quality and representativeness of our training data significantly impact the overall performance. The importance of comprehensive data exploration, meticulous data cleansing, and rigorous validation procedures cannot be overstated. These practices are critical for reducing biases and fortifying the overall resilience of our system.
- The selection of features must strike a balance between relevance and informativeness. Iterative refinement of features is essential for enhancing the model's predictive accuracy.
-  Handling imbalances in the severity classes is vital. Techniques such as oversampling minority classes or using appropriate evaluation metrics can lead to more robust models.
-  Acknowledging regional variations in accident patterns is crucial. Customizing the model or incorporating region-specific features can enhance its predictive power across diverse geographical areas.


## 8. Future work
- Experiment with advanced machine learning algorithms beyond decision trees, such as neural networks and systematically tune hyperparameters for optimal performance. 
- Validating with robust cross-validation methods and evaluating beyond accuracy metrics will provide a nuanced understanding of the model's performance.
- Collaborate with stakeholders, including transportation authorities, to align the model with practical needs. Establish continuous monitoring systems and feedback loops to ensure ongoing accuracy and relevance.


## References
-  Data Source : Crash Reporting - Drivers Data (2015 - 2023) | Montgomery county, Maryland.
   (https://catalog.data.gov/dataset/crash-reporting-drivers-data)
- https://plotly.com/python-api-reference/
- https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/
- https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html
- https://pythonbasics.org/what-is-flask-python/
